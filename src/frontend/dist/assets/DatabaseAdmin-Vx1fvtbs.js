import{j as e}from"./index-Ddi5eUMj.js";import{r as l}from"./vendor-DiiPbxpF.js";import{a as n}from"./api-Crk1tEXO.js";import"./router-Cc-_B42c.js";function f(){const[t,c]=l.useState(null),[r,o]=l.useState(null),[m,x]=l.useState([]),[h,d]=l.useState(!0),[i,p]=l.useState("overview");l.useEffect(()=>{(async()=>{try{d(!0);try{const a=await n.admin.getDatabaseStats();c(a)}catch(a){console.error("Failed to fetch database stats:",a)}try{const a=await n.admin.getSampleDataStatus();o(a)}catch(a){console.error("Failed to fetch sample data status:",a)}x([{name:"Users",rowCount:t?.totalUsers||0,description:"System users with authentication and profile data",primaryKey:"Id (Guid)",relationships:["Tenants","UserRoles","Documents","UserAuditEntries"]},{name:"Tenants",rowCount:t?.totalTenants||0,description:"Multi-tenant organizations with billing and configuration",primaryKey:"Id (Guid)",relationships:["Users","Documents","TenantModules","Roles"]},{name:"Documents",rowCount:t?.totalDocuments||0,description:"Core documents with content, metadata, and versioning",primaryKey:"Id (Guid)",relationships:["Users","Tenants","DocumentTags","DocumentPermissions","DocumentAuditEntries"]},{name:"Roles",rowCount:t?.totalRoles||0,description:"System and tenant-specific user roles",primaryKey:"Id (Guid)",relationships:["UserRoles","RolePermissions","DocumentPermissions"]},{name:"DocumentTags",rowCount:0,description:"Document categorization and search tags",primaryKey:"Id (Guid)",relationships:["Documents"]},{name:"DocumentPermissions",rowCount:0,description:"Access control for documents by user or role",primaryKey:"Id (Guid)",relationships:["Documents","Users","Roles"]},{name:"UserRoles",rowCount:0,description:"User role assignments with expiration support",primaryKey:"Id (Guid)",relationships:["Users","Roles"]},{name:"TenantModules",rowCount:0,description:"Module configurations per tenant",primaryKey:"Id (Guid)",relationships:["Tenants"]},{name:"AuditEntries",rowCount:t?.totalAuditEntries||0,description:"Comprehensive audit trail for all system activities",primaryKey:"Id (Guid)",relationships:["Documents","Users","Tenants"]}]),d(!1)}catch(a){console.error("Failed to fetch database info:",a),d(!1)}})()},[t?.totalUsers,t?.totalTenants,t?.totalDocuments,t?.totalRoles]);const u=async()=>{try{await n.admin.seedSampleData(),alert("Sample data seeded successfully!"),window.location.reload()}catch(s){alert(`Failed to seed data: ${s.message||"Unknown error"}`)}},g=async()=>{if(window.confirm(`Are you sure you want to clear ALL data? This action cannot be undone.

This will delete:
- All tenants and users
- All documents and attachments
- All permissions and audit entries
- All tenant modules and configurations

System roles will be preserved.`))if(window.prompt('Type "CONFIRM_DELETE_ALL_DATA" to proceed:')==="CONFIRM_DELETE_ALL_DATA")try{await n.admin.clearAllData("CONFIRM_DELETE_ALL_DATA"),alert("All data cleared successfully!"),window.location.reload()}catch(j){alert(`Failed to clear data: ${j.message||"Unknown error"}`)}else alert("Confirmation text does not match. Operation cancelled.")};return h?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-6"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[...Array(6)].map((s,a)=>e.jsxs("div",{className:"bg-white p-6 rounded-lg border shadow-sm",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"})]},a))})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Database Administration"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor database health, manage sample data, and explore table structures"})]}),e.jsx("div",{className:"mt-4 sm:mt-0 flex space-x-3",children:e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"🔄 Refresh"})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:"📊"},{id:"tables",label:"Table Structure",icon:"🗂️"},{id:"sample-data",label:"Sample Data",icon:"🔍"},{id:"operations",label:"Operations",icon:"⚙️"}].map(s=>e.jsxs("button",{onClick:()=>p(s.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${i===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"mr-2",children:s.icon}),s.label]},s.id))})}),i==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Database Status"}),e.jsxs("p",{className:"text-green-100 mt-1",children:["PostgreSQL • ",t?.systemHealth?.database?"Connected":"Disconnected"," • Size: ",t?.databaseSize||"Unknown"]})]}),e.jsx("div",{className:"text-4xl",children:"✅"})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🏢"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.totalTenants||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Tenants"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"👥"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.totalUsers||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Users"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"📄"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.totalDocuments||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Documents"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🏷️"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Tags"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🔐"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.totalPermissions||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Permissions"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"📝"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.totalAuditEntries||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Audit Entries"})]})]})]}),i==="tables"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Database Tables"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Multi-tenant enterprise schema with comprehensive relationships"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Table Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Row Count"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Primary Key"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Relationships"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:s.rowCount})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.primaryKey}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:s.description}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.relationships.map(a=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs bg-gray-100 text-gray-600",children:a},a))})})]},s.name))})]})})]})}),i==="sample-data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Sample Data Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-3xl mb-2 ${r?.hasSampleData?"text-green-600":"text-red-600"}`,children:r?.hasSampleData?"✅":"❌"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Sample Data"}),e.jsx("div",{className:"text-xs text-gray-600",children:r?.hasSampleData?"Present":"Not Found"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-3xl mb-2 ${r?.hasSampleData?"text-green-600":"text-red-600"}`,children:r?.hasSampleData?"👤":"❌"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Sample Data"}),e.jsx("div",{className:"text-xs text-gray-600",children:r?.hasSampleData?"Available":"Missing"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2 text-blue-600",children:"🏢"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r?.counts?.tenants||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Sample Tenants"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2 text-purple-600",children:"👥"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r?.counts?.users||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Users"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2 text-orange-600",children:"📄"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r?.counts?.documents||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Documents"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Sample Data Structure"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"🏢 Demo Tenants"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Acme Legal Services"})," - Professional tier"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"TechStart Inc"})," - Starter tier (trial)"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Global Consulting Group"})," - Enterprise tier"]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"👥 Sample Users"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Demo User (System Admin)"}),e.jsx("li",{children:"• Legal professionals (4 users)"}),e.jsx("li",{children:"• Tech startup team (2 users)"}),e.jsx("li",{children:"• Consulting experts (2 users)"})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"📄 Sample Documents"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Legal contracts & agreements"}),e.jsx("li",{children:"• Tech product requirements"}),e.jsx("li",{children:"• Consulting analysis reports"}),e.jsx("li",{children:"• Complete metadata & tags"})]})]})]})]})]}),i==="operations"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Database Operations"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border border-green-200 rounded-lg p-6 bg-green-50",children:[e.jsx("h3",{className:"text-lg font-medium text-green-800 mb-2",children:"Seed Sample Data"}),e.jsx("p",{className:"text-green-700 text-sm mb-4",children:"Populate the database with comprehensive sample data including tenants, users, documents, and relationships."}),e.jsxs("ul",{className:"text-sm text-green-600 mb-4 space-y-1",children:[e.jsx("li",{children:"• 3 multi-tenant organizations"}),e.jsx("li",{children:"• 8 professional users with roles"}),e.jsx("li",{children:"• 7 industry-specific documents"}),e.jsx("li",{children:"• Complete audit trails and permissions"})]}),e.jsx("button",{onClick:u,className:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"🌱 Seed Sample Data"})]}),e.jsxs("div",{className:"border border-red-200 rounded-lg p-6 bg-red-50",children:[e.jsx("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Clear All Data"}),e.jsx("p",{className:"text-red-700 text-sm mb-4",children:"Remove all data from the database for production deployment. System roles will be preserved."}),e.jsxs("ul",{className:"text-sm text-red-600 mb-4 space-y-1",children:[e.jsx("li",{children:"• All tenants and users"}),e.jsx("li",{children:"• All documents and attachments"}),e.jsx("li",{children:"• All permissions and audit entries"}),e.jsx("li",{children:"• All tenant modules and configurations"})]}),e.jsx("button",{onClick:g,className:"w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"🗑️ Clear All Data"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Available API Endpoints"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("code",{className:"text-sm font-mono text-gray-800",children:"GET /api/admin/database-stats"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Get database health and entity counts"})]}),e.jsx("span",{className:"text-green-600 text-sm font-medium",children:"PUBLIC"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("code",{className:"text-sm font-mono text-gray-800",children:"GET /api/admin/sample-data-status"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Check if sample data exists"})]}),e.jsx("span",{className:"text-green-600 text-sm font-medium",children:"PUBLIC"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("code",{className:"text-sm font-mono text-gray-800",children:"POST /api/admin/seed-sample-data"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Populate database with sample data"})]}),e.jsx("span",{className:"text-orange-600 text-sm font-medium",children:"ADMIN"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("code",{className:"text-sm font-mono text-gray-800",children:"DELETE /api/admin/clear-all-data"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Clear all data (requires confirmation)"})]}),e.jsx("span",{className:"text-red-600 text-sm font-medium",children:"ADMIN"})]})]})]})]})]})}export{f as default};
