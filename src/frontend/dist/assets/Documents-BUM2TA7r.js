import{j as e,L as B}from"./index-CJn64ckD.js";import{r as i}from"./vendor-DiiPbxpF.js";import{d as z}from"./api-BVFMFJC7.js";import"./router-Cc-_B42c.js";const U=({searchTerm:c,onDocumentSelect:m,onDocumentEdit:o,onDocumentDelete:N})=>{const[f,b]=i.useState([]),[u,l]=i.useState(!0),[y,h]=i.useState(null),[a,j]=i.useState(1),[v,d]=i.useState(0),[x,D]=i.useState("updatedAt"),[w,F]=i.useState("desc"),C=20;i.useEffect(()=>{k()},[a,c,x,w]);const k=async()=>{try{l(!0),h(null);const s={page:a,pageSize:C};c&&(s.searchTerm=c);const r=await z.getDocuments(s);b(r.items),d(r.totalCount)}catch(s){h(s instanceof Error?s.message:"Failed to load documents")}finally{l(!1)}},S=s=>{s===x?F(w==="asc"?"desc":"asc"):(D(s),F("asc"))},M=async s=>{if(window.confirm("Are you sure you want to delete this document?"))try{await z.deleteDocument(s),await k(),N?.(s)}catch(r){h(r instanceof Error?r.message:"Failed to delete document")}},A=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),t=Math.ceil(v/C);return u?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx(B,{})}):y?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"text-red-600",children:[e.jsx("span",{className:"font-medium",children:"Error:"})," ",y]}),e.jsx("button",{onClick:k,className:"ml-4 px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Retry"})]})}):f.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"No documents found"}),c&&e.jsx("div",{className:"text-gray-400 text-sm",children:"Try adjusting your search terms"})]}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>S("title"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Title"}),x==="title"&&e.jsx("span",{className:"text-gray-400",children:w==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tags"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>S("createdAt"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Created"}),x==="createdAt"&&e.jsx("span",{className:"text-gray-400",children:w==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>S("updatedAt"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Modified"}),x==="updatedAt"&&e.jsx("span",{className:"text-gray-400",children:w==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("button",{onClick:()=>m?.(s),className:"text-left text-sm font-medium text-blue-600 hover:text-blue-800 truncate max-w-xs",title:s.title,children:s.title}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1 truncate max-w-xs",children:[s.content.substring(0,100),s.content.length>100&&"..."]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.tags.slice(0,3).map(r=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:r},r)),s.tags.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.tags.length-3," more"]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:A(s.createdAt)}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:A(s.updatedAt)}),e.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>m?.(s),className:"text-blue-600 hover:text-blue-900",title:"View document",children:"View"}),e.jsx("button",{onClick:()=>o?.(s),className:"text-green-600 hover:text-green-900",title:"Edit document",children:"Edit"}),e.jsx("button",{onClick:()=>M(s.id),className:"text-red-600 hover:text-red-900",title:"Delete document",children:"Delete"})]})})]},s.id))})]})}),t>1&&e.jsx("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>j(Math.max(1,a-1)),disabled:a===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>j(Math.min(t,a+1)),disabled:a===t,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:(a-1)*C+1})," ","to"," ",e.jsx("span",{className:"font-medium",children:Math.min(a*C,v)})," ","of ",e.jsx("span",{className:"font-medium",children:v})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>j(Math.max(1,a-1)),disabled:a===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,t)},(s,r)=>{const n=r+1;return e.jsx("button",{onClick:()=>j(n),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${n===a?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:n},n)}),e.jsx("button",{onClick:()=>j(Math.min(t,a+1)),disabled:a===t,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})})]})]})})]})})},L=({onUploadComplete:c,onCancel:m,className:o=""})=>{const[N,f]=i.useState(!1),[b,u]=i.useState([]),[l,y]=i.useState({title:"",description:"",tags:""}),h=[".pdf",".doc",".docx",".txt",".md",".xls",".xlsx",".ppt",".pptx",".jpg",".jpeg",".png",".gif",".zip",".rar",".7z"],a=50*1024*1024,j=t=>{if(t.size>a)return`File size must be less than ${a/(1024*1024)}MB`;const s="."+t.name.split(".").pop()?.toLowerCase();return h.includes(s)?null:`File type ${s} is not supported`},v=t=>{if(t===0)return"0 Bytes";const s=1024,r=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,n)).toFixed(2))+" "+r[n]},d=async t=>{u(s=>[...s,{file:t,progress:0,status:"uploading"}]);try{const s=p=>{u(g=>g.map(E=>E.file===t?{...E,progress:p}:E))};for(let p=10;p<=90;p+=10)await new Promise(g=>setTimeout(g,100)),s(p);const r=new FormData;r.append("file",t),r.append("title",l.title||t.name),r.append("description",l.description),l.tags&&l.tags.split(",").map(g=>g.trim()).filter(Boolean).forEach(g=>r.append("tags",g));const n=await z.createDocument({title:l.title||t.name,content:l.description||`Uploaded file: ${t.name}`,tags:l.tags?l.tags.split(",").map(p=>p.trim()).filter(Boolean):[]});s(100),u(p=>p.map(g=>g.file===t?{...g,status:"completed",documentId:n.id}:g)),c?.(n)}catch(s){u(r=>r.map(n=>n.file===t?{...n,status:"error",error:s instanceof Error?s.message:"Upload failed"}:n))}},x=t=>{const s=Array.from(t);for(const r of s){const n=j(r);if(n){alert(`${r.name}: ${n}`);continue}d(r)}},D=i.useCallback(t=>{t.preventDefault(),t.stopPropagation(),t.type==="dragenter"||t.type==="dragover"?f(!0):t.type==="dragleave"&&f(!1)},[]),w=i.useCallback(t=>{t.preventDefault(),t.stopPropagation(),f(!1),t.dataTransfer.files&&t.dataTransfer.files[0]&&x(t.dataTransfer.files)},[]),F=t=>{t.target.files&&t.target.files[0]&&x(t.target.files)},C=t=>{u(s=>s.filter(r=>r.file!==t))},k=()=>{u(t=>t.filter(s=>s.status!=="completed"))},S=b.length>0,M=b.some(t=>t.status==="completed"),A=b.length>0&&b.every(t=>t.status==="completed");return e.jsxs("div",{className:`space-y-6 ${o}`,children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Document Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",id:"title",value:l.title,onChange:t=>y(s=>({...s,title:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter document title (optional - will use filename if empty)"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{id:"description",rows:3,value:l.description,onChange:t=>y(s=>({...s,description:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter document description"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),e.jsx("input",{type:"text",id:"tags",value:l.tags,onChange:t=>y(s=>({...s,tags:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter tags separated by commas (e.g., legal, contract, important)"})]})]})]}),e.jsx("div",{className:`relative border-2 border-dashed rounded-lg p-8 text-center transition-colors ${N?"border-blue-400 bg-blue-50":"border-gray-300 bg-gray-50 hover:bg-gray-100"}`,onDragEnter:D,onDragLeave:D,onDragOver:D,onDrop:w,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-4xl text-gray-400",children:"📁"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Drop files here or click to upload"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Supports: ",h.join(", ")]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Maximum file size: ",a/(1024*1024),"MB"]})]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",multiple:!0,accept:h.join(","),onChange:F,className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer",children:"Choose Files"})]})]})}),S&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Upload Progress"}),M&&e.jsx("button",{onClick:k,className:"text-sm text-blue-600 hover:text-blue-700",children:"Clear Completed"})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:b.map((t,s)=>e.jsxs("div",{className:"p-4 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.file.name}),e.jsx("p",{className:"text-xs text-gray-500",children:v(t.file.size)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[t.status==="uploading"&&`${t.progress}%`,t.status==="completed"&&"✓ Complete",t.status==="error"&&"✗ Failed"]}),e.jsx("button",{onClick:()=>C(t.file),className:"text-gray-400 hover:text-gray-600",title:"Remove",children:"✕"})]})]}),t.status==="uploading"&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${t.progress}%`}})}),t.status==="error"&&t.error&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:t.error}),t.status==="completed"&&e.jsx("div",{className:"w-full bg-green-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full w-full"})})]},s))})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[m&&e.jsx("button",{onClick:m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),A&&e.jsx("button",{onClick:()=>{u([]),y({title:"",description:"",tags:""})},className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Done"})]})]})};function V(){const[c,m]=i.useState("list"),[o,N]=i.useState(null),[f,b]=i.useState(""),[u,l]=i.useState(0),y=d=>{N(d),m("detail")},h=d=>{N(d),m("detail")},a=d=>{l(x=>x+1)},j=d=>{l(x=>x+1),m("list")},v=d=>new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Documents"}),c==="list"&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search documents...",value:f,onChange:d=>b(d.target.value),className:"w-64 px-4 py-2 pl-10 pr-4 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),e.jsx("button",{onClick:()=>m("upload"),className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Upload Document"})]}),c!=="list"&&e.jsx("button",{onClick:()=>{m("list"),N(null)},className:"px-4 py-2 bg-gray-600 text-white text-sm font-medium rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Back to Documents"})]}),e.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"flex items-center space-x-4",children:[e.jsx("li",{children:e.jsx("div",{className:"flex items-center",children:e.jsx("button",{onClick:()=>m("list"),className:`text-sm font-medium ${c==="list"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"All Documents"})})}),c==="upload"&&e.jsx("li",{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"flex-shrink-0 h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.jsx("span",{className:"ml-4 text-sm font-medium text-blue-600",children:"Upload"})]})}),c==="detail"&&o&&e.jsx("li",{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"flex-shrink-0 h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),e.jsx("span",{className:"ml-4 text-sm font-medium text-blue-600 truncate max-w-md",title:o.title,children:o.title})]})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[c==="list"&&e.jsx("div",{className:"p-6",children:e.jsx(U,{searchTerm:f,onDocumentSelect:y,onDocumentEdit:h,onDocumentDelete:a},u)}),c==="upload"&&e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upload New Document"}),e.jsx(L,{onUploadComplete:j,onCancel:()=>m("list")})]}),c==="detail"&&o&&e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:o.title}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[e.jsxs("span",{children:["Created: ",v(o.createdAt)]}),e.jsxs("span",{children:["Modified: ",v(o.updatedAt)]})]})]}),o.tags.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.tags.map(d=>e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:d},d))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Content"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-900 font-mono",children:o.content||"No content available"})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>h(o),className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Edit Document"}),e.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this document?")&&(a(o.id),m("list"))},className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Document"})]})]})})]})]})}export{V as default};
