import{c as b,_ as E,j as e}from"./index-DkHF2ZzG.js";import{r as i}from"./vendor-DiiPbxpF.js";import{A as q}from"./dashboard-GOOrcU3e.js";import{A as p}from"./activity-DY7-DzCM.js";import{P as f}from"./plus-DrPwpC86.js";import{S as z,a as H}from"./shield-CZtWNgHf.js";import{S as G,E as U}from"./search-Djnu_hNM.js";import{B as A}from"./building-2-DvSXfUZ6.js";import{G as X,X as Z,C as k}from"./x-circle-CwGNlQ6j.js";import{U as J}from"./users-HqlCiR7E.js";import{F as K}from"./file-text-QrlsqnEI.js";import{D as Q}from"./dollar-sign-spJTcxY7.js";import{X as W}from"./x-Cf_MI-L8.js";import"./router-Cc-_B42c.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=b("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=b("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=b("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);function ge(){const[u,j]=i.useState([]),[h,T]=i.useState([]),[y,N]=i.useState(!0),[C,v]=i.useState(null),[c,F]=i.useState(""),[P,m]=i.useState(!1),[g,w]=i.useState(!1),[s,o]=i.useState({name:"",subdomain:"",domain:"",tier:"Trial",billingContactName:"",billingContactEmail:"",technicalContactName:"",technicalContactEmail:"",notes:""}),[l,x]=i.useState({status:"all",tier:"all",healthScore:"all",sortBy:"name",sortOrder:"asc"});i.useEffect(()=>{S()},[]),i.useEffect(()=>{$()},[u,c,l]);const S=async()=>{try{N(!0),v(null);const{platformAdminApi:t}=await E(async()=>{const{platformAdminApi:n}=await import("./api-DSWGjQU1.js");return{platformAdminApi:n}},[]),a=await t.getClients();j(a)}catch(t){console.error("Failed to fetch client data:",t),v(t instanceof Error?t.message:"Failed to load client data")}finally{N(!1)}},$=()=>{let t=[...u];c&&(t=t.filter(a=>a.name.toLowerCase().includes(c.toLowerCase())||a.subdomain.toLowerCase().includes(c.toLowerCase())||a.domain?.toLowerCase().includes(c.toLowerCase()))),l.status!=="all"&&(t=t.filter(a=>a.status.toLowerCase()===l.status.toLowerCase())),l.tier!=="all"&&(t=t.filter(a=>a.tier.toLowerCase()===l.tier.toLowerCase())),l.healthScore!=="all"&&(t=t.filter(a=>l.healthScore==="excellent"?a.healthScore>=90:l.healthScore==="good"?a.healthScore>=70&&a.healthScore<90:l.healthScore==="poor"?a.healthScore<70:!0)),t.sort((a,n)=>{let r=a[l.sortBy],d=n[l.sortBy];return typeof r=="string"&&(r=r.toLowerCase(),d=d.toLowerCase()),l.sortOrder==="asc"?r<d?-1:r>d?1:0:r>d?-1:r<d?1:0}),T(t)},O=t=>{const n={Active:{icon:k,color:"bg-green-100 text-green-800",iconColor:"text-green-600"},Trial:{icon:L,color:"bg-yellow-100 text-yellow-800",iconColor:"text-yellow-600"},Suspended:{icon:Y,color:"bg-orange-100 text-orange-800",iconColor:"text-orange-600"},Inactive:{icon:Z,color:"bg-red-100 text-red-800",iconColor:"text-red-600"},Pending:{icon:L,color:"bg-blue-100 text-blue-800",iconColor:"text-blue-600"}}[t],r=n?.icon||k;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n?.color||"bg-gray-100 text-gray-800"}`,children:[e.jsx(r,{size:12,className:`mr-1 ${n?.iconColor||"text-gray-600"}`}),t]})},D=t=>{let a="text-green-600";return t<70?a="text-red-600":t<90&&(a="text-yellow-600"),e.jsxs("div",{className:`flex items-center space-x-1 ${a}`,children:[e.jsx(p,{size:14}),e.jsxs("span",{className:"font-medium",children:[t,"%"]})]})},I=async()=>{try{w(!0);const{platformAdminApi:t}=await E(async()=>{const{platformAdminApi:r}=await import("./api-DSWGjQU1.js");return{platformAdminApi:r}},[]);if(!s.name.trim()){alert("Organization name is required");return}if(!s.subdomain.trim()){alert("Subdomain is required");return}if(!/^[a-z0-9-]+$/.test(s.subdomain)){alert("Subdomain can only contain lowercase letters, numbers, and hyphens");return}const a={name:s.name.trim(),subdomain:s.subdomain.trim().toLowerCase(),tier:s.tier,...s.domain.trim()&&{domain:s.domain.trim()},...s.billingContactName.trim()&&{billingContactName:s.billingContactName.trim()},...s.billingContactEmail.trim()&&{billingContactEmail:s.billingContactEmail.trim()},...s.technicalContactName.trim()&&{technicalContactName:s.technicalContactName.trim()},...s.technicalContactEmail.trim()&&{technicalContactEmail:s.technicalContactEmail.trim()},...s.notes.trim()&&{notes:s.notes.trim()}},n=await t.createClient(a);j(r=>[n,...r]),o({name:"",subdomain:"",domain:"",tier:"Trial",billingContactName:"",billingContactEmail:"",technicalContactName:"",technicalContactEmail:"",notes:""}),m(!1),alert(`Client "${n.name}" created successfully!`)}catch(t){console.error("Failed to create client:",t),alert(t instanceof Error?t.message:"Failed to create client")}finally{w(!1)}},_=t=>{o(a=>({...a,name:t,subdomain:a.subdomain||t.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,"").substring(0,50)}))},B=t=>{console.log(`View client details: ${t}`)},M=t=>{console.log(`Impersonate client: ${t}`)},R=t=>{console.log(`Manage client: ${t}`)},V=t=>{console.log(`Edit client: ${t}`)};return y?e.jsx("div",{className:"client-management",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner",children:e.jsx(p,{className:"animate-spin",size:48})}),e.jsx("p",{className:"loading-text",children:"Loading client organizations..."})]})}):e.jsxs("div",{className:"client-management",children:[C&&e.jsxs("div",{className:"alert alert-error mb-6",children:[e.jsx(q,{size:20}),e.jsx("span",{children:C}),e.jsx("button",{onClick:S,className:"btn btn-sm",children:"Retry"})]}),e.jsx("section",{className:"page-header mb-8",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Client Management"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage and monitor all client organizations across the platform"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[h.length," of ",u.length," clients displayed"]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary flex items-center space-x-2",children:[e.jsx(f,{size:16}),e.jsx("span",{children:"Add Client"})]}),e.jsxs("button",{className:"btn btn-secondary flex items-center space-x-2",children:[e.jsx(z,{size:16}),e.jsx("span",{children:"Bulk Actions"})]})]})]})}),e.jsx("section",{className:"search-filters mb-6",children:e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0 lg:space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(G,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clients by name, subdomain, or domain...",value:c,onChange:t=>F(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("select",{value:l.status,onChange:t=>x(a=>({...a,status:t.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"trial",children:"Trial"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsxs("select",{value:l.tier,onChange:t=>x(a=>({...a,tier:t.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Tiers"}),e.jsx("option",{value:"trial",children:"Trial"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"enterprise",children:"Enterprise"}),e.jsx("option",{value:"custom",children:"Custom"})]}),e.jsxs("select",{value:l.healthScore,onChange:t=>x(a=>({...a,healthScore:t.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Health"}),e.jsx("option",{value:"excellent",children:"Excellent (90%+)"}),e.jsx("option",{value:"good",children:"Good (70-89%)"}),e.jsx("option",{value:"poor",children:"Poor (<70%)"})]}),e.jsxs("select",{value:`${l.sortBy}-${l.sortOrder}`,onChange:t=>{const[a,n]=t.target.value.split("-");a&&n&&x(r=>({...r,sortBy:a,sortOrder:n}))},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"name-asc",children:"Name A-Z"}),e.jsx("option",{value:"name-desc",children:"Name Z-A"}),e.jsx("option",{value:"createdAt-desc",children:"Newest First"}),e.jsx("option",{value:"createdAt-asc",children:"Oldest First"}),e.jsx("option",{value:"monthlyRevenue-desc",children:"Revenue High-Low"}),e.jsx("option",{value:"healthScore-desc",children:"Health High-Low"})]})]})]})})}),e.jsx("section",{className:"client-list",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-900",children:"Organization"}),e.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-900",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-900",children:"Tier"}),e.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-900",children:"Users"}),e.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-900",children:"Documents"}),e.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-900",children:"Revenue"}),e.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-900",children:"Health"}),e.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:h.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(A,{size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.subdomain,".spaghetti.app"]}),t.domain&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(X,{size:10,className:"mr-1"}),t.domain]})]})]})}),e.jsx("td",{className:"py-4 px-6",children:O(t.status)}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.tier})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center space-x-1 text-gray-900",children:[e.jsx(J,{size:14}),e.jsx("span",{className:"font-medium",children:t.userCount})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center space-x-1 text-gray-900",children:[e.jsx(K,{size:14}),e.jsx("span",{className:"font-medium",children:t.documentCount.toLocaleString()})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center space-x-1 text-gray-900",children:[e.jsx(Q,{size:14}),e.jsx("span",{className:"font-medium",children:t.monthlyRevenue>0?`$${t.monthlyRevenue.toLocaleString()}`:"Trial"})]})}),e.jsx("td",{className:"py-4 px-6",children:D(t.healthScore)}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>B(t.id),className:"p-1 text-gray-400 hover:text-blue-600",title:"View details",children:e.jsx(U,{size:16})}),e.jsx("button",{onClick:()=>M(t.id),className:"p-1 text-gray-400 hover:text-green-600",title:"Impersonate",children:e.jsx(z,{size:16})}),e.jsx("button",{onClick:()=>V(t.id),className:"p-1 text-gray-400 hover:text-yellow-600",title:"Edit",children:e.jsx(ee,{size:16})}),e.jsx("button",{onClick:()=>R(t.id),className:"p-1 text-gray-400 hover:text-gray-600",title:"Manage",children:e.jsx(H,{size:16})})]})})]},t.id))})]})}),h.length===0&&!y&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No clients found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:c||l.status!=="all"||l.tier!=="all"?"Try adjusting your search or filters":"Get started by adding your first client organization"}),!c&&l.status==="all"&&l.tier==="all"&&e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary",children:[e.jsx(f,{size:16,className:"mr-2"}),"Add First Client"]})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Create New Client Organization"}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(W,{size:24})})]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),I()},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Organization Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name *"}),e.jsx("input",{type:"text",value:s.name,onChange:t=>_(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g. Acme Legal Partners",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subdomain *"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"text",value:s.subdomain,onChange:t=>o(a=>({...a,subdomain:t.target.value.toLowerCase()})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"acme-legal",pattern:"^[a-z0-9-]+$",required:!0}),e.jsx("span",{className:"px-3 py-2 bg-gray-100 border border-l-0 border-gray-300 rounded-r-lg text-gray-600",children:".spaghetti.app"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Only lowercase letters, numbers, and hyphens"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Domain (Optional)"}),e.jsx("input",{type:"text",value:s.domain,onChange:t=>o(a=>({...a,domain:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g. docs.acmelegal.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subscription Tier *"}),e.jsxs("select",{value:s.tier,onChange:t=>o(a=>({...a,tier:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"Trial",children:"Trial (Free, 30 days)"}),e.jsx("option",{value:"Professional",children:"Professional ($799/month)"}),e.jsx("option",{value:"Enterprise",children:"Enterprise ($2,499/month)"}),e.jsx("option",{value:"Custom",children:"Custom (Contact sales)"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Billing Contact Name"}),e.jsx("input",{type:"text",value:s.billingContactName,onChange:t=>o(a=>({...a,billingContactName:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"John Smith"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Billing Contact Email"}),e.jsx("input",{type:"email",value:s.billingContactEmail,onChange:t=>o(a=>({...a,billingContactEmail:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"billing@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Technical Contact Name"}),e.jsx("input",{type:"text",value:s.technicalContactName,onChange:t=>o(a=>({...a,technicalContactName:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Jane Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Technical Contact Email"}),e.jsx("input",{type:"email",value:s.technicalContactEmail,onChange:t=>o(a=>({...a,technicalContactEmail:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tech@example.com"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Platform Admin Notes"}),e.jsx("textarea",{value:s.notes,onChange:t=>o(a=>({...a,notes:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Internal notes about this client organization..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"btn btn-secondary",disabled:g,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary flex items-center space-x-2",disabled:g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"animate-spin",size:16}),e.jsx("span",{children:"Creating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{size:16}),e.jsx("span",{children:"Create Client"})]})})]})]})]})})})]})}export{ge as default};
